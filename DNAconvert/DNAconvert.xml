<tool id="DNAconvert" name="DNAconvert" version="0.2.0" python_template_version="3.5" profile="21.05">
    <description>Converts genetic sequences between different formats</description>
    <requirements>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[$__tool_directory__/DNAconvert '$input1' '$output1' '--cmd' 
          #if $allow_empty_sequences: 
             --allow_empty_sequence 
          #end if
          #if $disable_automatic_renaming: 
             --disable_automatic_renaming
          #end if
            --informat '$informat1'
	 --outformat '$outformat_and_extension.outformat1' ]]>
    </command>
    <inputs>
        <param  type="data" name="input1" label="Source file" format="data" />
        <param name="informat1" type="select" label="Input Format">
           <option value="tab">Internal tab format</option>
           <option value="tab_noheaders">Internal tab format without headers</option>
           <option value="fasta">FASTA format</option>
           <option value="fasta_hapview">FASTA format for Haplotype Viewer</option>
           <option value="fasta_gbexport">FASTA format for export into Genbank repository</option>
           <option value="mold_fasta">FASTA format with sequence name matching requirements for the tool MolD</option>
           <option value="fastq">FASTQ format</option>
           <option value="phylip">Phylip format</option>
           <option value="relaxed_phylip">relaxed Phylip format</option>
           <option value="nexus">NEXUS format</option>
           <option value="nexml">DnaCharacterMatrix in NeXML format</option>
           <option value="genbank">Genbank flat file format</option>
        </param>
        <conditional name="outformat_and_extension">
          <param name="outformat1" type="select" label="Output Format">
             <option value="tab">Internal tab format</option>
             <option value="tab_noheaders">Internal tab format without headers</option>
             <option value="fasta">FASTA format</option>
             <option value="fasta_hapview">FASTA format for Haplotype Viewer</option>
             <option value="fasta_gbexport">FASTA format for export into Genbank repository</option>
             <option value="mold_fasta">FASTA format with sequence name matching requirements for the tool MolD</option>
             <option value="fastq">FASTQ format</option>
             <option value="phylip">Phylip format</option>
             <option value="relaxed_phylip">relaxed Phylip format</option>
             <option value="nexus">NEXUS format</option>
             <option value="nexml">DnaCharacterMatrix in NeXML format</option>
             <option value="genbank">Genbank flat file format</option>
          </param>
          <when value="tab">
            <param name="extension1" type="hidden" value="tab"/>
          </when>
          <when value="phylip">
            <param name="extension1" type="hidden" value="phy"/>
          </when>
          <when value="fasta">
            <param name="extension1" type="hidden" value="fas"/>
          </when>
          <when value="fasta_hapview">
            <param name="extension1" type="hidden" value="fas"/>
          </when>
          <when value="fasta_gbexport">
            <param name="extension1" type="hidden" value="fas"/>
          </when>
          <when value="mold_fasta">
            <param name="extension1" type="hidden" value="fas"/>
          </when>
          <when value="fastq">
            <param name="extension1" type="hidden" value="fq"/>
          </when>
          <when value="tab_noheaders">
            <param name="extension1" type="hidden" value="tab"/>
          </when>
          <when value="relaxed_phylip">
            <param name="extension1" type="hidden" value="phy"/>
          </when>
          <when value="nexus">
            <param name="extension1" type="hidden" value="nex"/>
          </when>
          <when value="nexml">
            <param name="extension1" type="hidden" value="xml"/>
          </when>
          <when value="genbank">
            <param name="extension1" type="hidden" value="gb"/>
          </when>
        </conditional>          

        <param name="allow_empty_sequences" type="boolean" label="Allow empty sequences"  help="set this to keep the empty sequences in the output file" />
        <param name="disable_automatic_renaming" type="boolean" label="Disable automatic renaming"  help="disables automatic renaming, may result in duplicate sequence names in Phylip and Nexus files" />
    </inputs>
    <outputs>
        <data name="output1" label="${os.path.splitext(os.path.basename($input1.name))[0]}.${outformat_and_extension.extension1}"  metadata_source="input1" format="tabular">
           <change_format>
              <when input="outformat_and_extension.outformat1" value="phylip" format="phylip" />
              <when input="outformat_and_extension.outformat1" value="fasta" format="fasta" />
              <when input="outformat_and_extension.outformat1" value="tab_noheaders" format="tabular" />
              <when input="outformat_and_extension.outformat1" value="tab" format="tabular" />
              <when input="outformat_and_extension.outformat1" value="fasta_hapview" format="fasta" />
              <when input="outformat_and_extension.outformat1" value="fastq" format="fastq" />
              <when input="outformat_and_extension.outformat1" value="relaxed_phylip" format="phylip" />
              <when input="outformat_and_extension.outformat1" value="nexus" format="nexus" />
              <when input="outformat_and_extension.outformat1" value="nexml" format="nexml" />
              <when input="outformat_and_extension.outformat1" value="genbank" format="gb" />
              <when input="outformat_and_extension.outformat1" value="mold_fasta" format="fasta" />
           </change_format>
        </data>
    </outputs>
  <tests>
    <test>
      <param name="input1" value="DNAconvert_examplefile2_iTaxoTools_0_1.fas"/>
      <param name="informat1" value="fasta" />
      <param name="outformat1" value="tab" />
      <output name="output1" file="DNAtestout_1.tab"/>
    </test>
    <test>
      <param name="input1" value="DNAconvert_examplefile3_iTaxoTools_0_1.tab"/>
      <param name="informat1" value="tab" />
      <param name="outformat1" value="phylip" />
      <output name="output1" file="DNAtestout_2.phy"/>
    </test>
  </tests> 
    <help><![CDATA[
Convert between different file formats containing genetic information. 

**Usage**
usage: DNAconvert [-h] [--cmd] [--allow_empty_sequences] [--informat INFORMAT] [--outformat OUTFORMAT] [infile] [outfile]

positional arguments:
  - infile                the input file
  - outfile               the output file

optional arguments:
::

  -h, --help show this help message and exit
  --cmd activates the command-line interface
  --allow_empty_sequences set this to keep the empty sequences in the output file
  --disable_automatic_renaming disables automatic renaming, may result in duplicate sequence names in Phylip and Nexus files
  --informat INFORMAT format of the input file
  --outformat OUTFORMAT format of the output file


**Supported formats**
::

* `tab`: [Internal tab format][1]
* `tab_noheaders`: [Internal tab format][1] without headers
* `fasta`: FASTA format
* `relaxed_phylip`: relaxed Phylip format
* `fasta_hapview`: FASTA format for Haplotype Viewer
* `phylip`: Phylip format
* `fastq`: FASTQ format
* `fasta_gbexport`: FASTA format for export into Genbank repository
* `nexus`: NEXUS format
* `nexml`: DnaCharacterMatrix in NeXML format
* `genbank`: Genbank flat file format
* `mold_fasta`: FASTA format with sequence name matching requirements for the tool MolD *



**Recognised extension**
Automatic recognition not available with Galaxy yet. 

GUI versions for Windows an Linux are available at https://github.com/iTaxoTools/iTaxoTools-Executables/releases
    ]]></help>
    <citations>
	<citation type="doi">
	    10.11646/megataxa.6.2.1 
	</citation>
    </citations>
</tool>
